schema: '2.0'
stages:
  preprocess_dataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: e318decabafbc20513b3b0184505ffc3
      size: 540
    params:
      params.yaml:
        preprocess_dataset.smiles2graph:
          cls: src.smiles.Smiles2GraphOGBConverter
          args: {}
    outs:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
  train_supervised@diffpool:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_supervised.py --model-name
      diffpool --config-path experiments/configs/diffpool.yaml --checkpoint-dir data/supervised/diffpool/checkpoints
      --save-test-dir data/supervised/diffpool/submssion --metrics-path data/metrics/supervised/diffpool.json
      --log-dir data/supervised/diffpool/logs
    deps:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
    params:
      experiments/configs/diffpool.yaml:
        args:
          graph_pooling: sum
          drop_ratio: 0
          num_layers: 5
          emb_dim: 600
        data_loader_args:
          batch_size: 256
        dataset: ogb.lsc.DglPCQM4MDataset
        learning_args:
          epochs: 1
        reg: torch.nn.L1Loss
        step_lr:
          step_size: 300
          gamma: 0.25
    outs:
    - path: data/metrics/supervised/diffpool.json
      md5: 4a0fff2b6ef9d11c0379d34e5c40c262
      size: 150
    - path: data/supervised/diffpool/
      md5: 1b0b549409741e30d256b001650e194f.dir
      size: 94434306
      nfiles: 3
  train_gae:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_unsupervised.py gae
    deps:
    - path: data/dataset/
      md5: 4a50c6545464f8a04bfcc49d2a660d25.dir
      size: 8538784731
      nfiles: 6
    - path: experiments/scripts/train_unsupervised.py
      md5: a77d8bb74097fac2fb25ccef90ca33db
      size: 10390
    - path: src/models/gae.py
      md5: 5f3b8c938d2a0050cc9fbc07ea616ff7
      size: 6258
    params:
      params.yaml:
        gae:
          num_layers: 3
          emb_dim: 128
          batch_size: 512
          epochs: 5
    outs:
    - path: data/checkpoints/gae/
      md5: 5463e786919efe31d7c809e8971b9666.dir
      size: 1307075
      nfiles: 1
    - path: data/logs/gae/
      md5: 31626e31a1588d6b1d32ebd841b1a882.dir
      size: 1925
      nfiles: 1
    - path: data/metrics/gae.json
      md5: 8bc5236df1c5d669977b08d1003cfdc2
      size: 37
    - path: data/submissions/gae/
      md5: dbadc5ec82cacfa7018b4fee54c39021.dir
      size: 1280559
      nfiles: 1
  train_gunet:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_unsupervised.py gunet
    deps:
    - path: data/dataset/
      md5: 4a50c6545464f8a04bfcc49d2a660d25.dir
      size: 8538784731
      nfiles: 6
    - path: experiments/scripts/train_unsupervised.py
      md5: a77d8bb74097fac2fb25ccef90ca33db
      size: 10390
    - path: src/models/gunet.py
      md5: c17ee51077f8a5fd468cacf4910928ed
      size: 2454
    params:
      params.yaml:
        gunet:
          depth: 3
          emb_dim: 128
          batch_size: 512
          epochs: 5
    outs:
    - path: data/checkpoints/gunet/
      md5: 29456cb1f10ccdc437cabec3234d1c98.dir
      size: 457645
      nfiles: 1
    - path: data/logs/gunet/
      md5: 7f86323007cdd5c7add23bc4d5ba9bb8.dir
      size: 1925
      nfiles: 1
    - path: data/metrics/gunet.json
      md5: 7d38e4202423228866a13746e18cee0d
      size: 37
    - path: data/submissions/gunet/
      md5: c7c798687af91e1227efd4d86b4d5cc1.dir
      size: 1271490
      nfiles: 1
