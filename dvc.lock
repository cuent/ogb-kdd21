schema: '2.0'
stages:
  preprocess_dataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: e318decabafbc20513b3b0184505ffc3
      size: 540
    params:
      params.yaml:
        preprocess_dataset.smiles2graph:
          cls: src.smiles.Smiles2GraphOGBConverter
          args: {}
    outs:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
  train_supervised@diffpool:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_supervised.py --model-name
      diffpool --config-path experiments/configs/diffpool.yaml --checkpoint-dir data/supervised/diffpool/checkpoints
      --save-test-dir data/supervised/diffpool/submssion --metrics-path data/metrics/supervised/diffpool.json
      --log-dir data/supervised/diffpool/logs
    deps:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
    params:
      experiments/configs/diffpool.yaml:
        args:
          graph_pooling: sum
          drop_ratio: 0
          num_layers: 5
          emb_dim: 600
        data_loader_args:
          batch_size: 256
        dataset: ogb.lsc.DglPCQM4MDataset
        learning_args:
          epochs: 1
        reg: torch.nn.L1Loss
        step_lr:
          step_size: 300
          gamma: 0.25
    outs:
    - path: data/metrics/supervised/diffpool.json
      md5: 4a0fff2b6ef9d11c0379d34e5c40c262
      size: 150
    - path: data/supervised/diffpool/
      md5: 1b0b549409741e30d256b001650e194f.dir
      size: 94434306
      nfiles: 3
  train_supervised@graph-unet:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_supervised.py --model-name
      graph-unet --config-path experiments/configs/graph-unet.yaml --checkpoint-dir
      data/supervised/graph-unet/checkpoints --save-test-dir data/supervised/graph-unet/submssion
      --metrics-path data/metrics/supervised/graph-unet.json --log-dir data/supervised/graph-unet/logs
    deps:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
    params:
      experiments/configs/graph-unet.yaml:
        args:
          depth: 3
          emb_dim: 600
        data_loader_args:
          batch_size: 512
        dataset: ogb.lsc.PygPCQM4MDataset
        learning_args:
          epochs: 15
        reg: torch.nn.L1Loss
        step_lr:
          step_size: 5
          gamma: 0.25
    outs:
    - path: data/metrics/supervised/graph-unet.json
      md5: 59d3d63b0cec5bbfcb0f01e6d98b2079
      size: 148
    - path: data/supervised/graph-unet/
      md5: 01825508c6d5bca8204de5ad999a35dc.dir
      size: 18851207
      nfiles: 3
