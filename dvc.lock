schema: '2.0'
stages:
  preprocess_dataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: e318decabafbc20513b3b0184505ffc3
      size: 540
    params:
      params.yaml:
        preprocess_dataset.smiles2graph:
          cls: src.smiles.Smiles2GraphOGBConverter
          args: {}
    outs:
    - path: data/dataset/
      md5: b73ffb2c0b23563450be11ad150e6806.dir
      size: 20116395933
      nfiles: 7
  train_supervised@diffpool:
    cmd: PYTHONPATH=. python3 experiments/scripts/train_supervised.py --model-name
      diffpool --config-path experiments/configs/diffpool.yaml --checkpoint-dir data/supervised/diffpool/checkpoints
      --save-test-dir data/supervised/diffpool/submssion --metrics-path data/metrics/supervised/diffpool.json
      --log-dir data/supervised/diffpool/logs
    deps:
    - path: data/dataset/
      md5: 8b886171ea97fdd5f4f3b85287328f1f.dir
      size: 23449500672
      nfiles: 8
    params:
      experiments/configs/diffpool.yaml:
        args:
          graph_pooling: sum
          drop_ratio: 0
          num_layers: 5
          emb_dim: 600
        data_loader_args:
          batch_size: 256
        dataset: ogb.lsc.DglPCQM4MDataset
        learning_args:
          epochs: 30
        reg: torch.nn.L1Loss
        step_lr:
          step_size: 300
          gamma: 0.25
    outs:
    - path: data/metrics/supervised/diffpool.json
      md5: e34d77387fe24f93ea925d913845e761
      size: 152
    - path: data/supervised/diffpool/
      md5: 77b461fb8300f77829d007d8a632ea17.dir
      size: 96193735
      nfiles: 3
  preprocess_dataset@PygPCQM4MDataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py --dataset
      PygPCQM4MDataset
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: b9e78868a67857c569f56f3dda12b843
      size: 764
    - path: params.yaml
      md5: b82edea341646bf25fd546adde5813c0
      size: 626
    outs:
    - path: data/dataset/pcqm4m_kddcup2021/processed/geometric_data_processed.pt
      md5: d3d5134387a081ede17855f5d0d812c4
      size: 8451179131
  preprocess_dataset@LinearPCQM4MDataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py --dataset
      LinearPCQM4MDataset
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: b9e78868a67857c569f56f3dda12b843
      size: 764
    - path: params.yaml
      md5: b82edea341646bf25fd546adde5813c0
      size: 626
    outs:
    - path: data/dataset/pcqm4m_kddcup2021/processed/graph_ft.pt
      md5: 08245ed3273583de3ab362b702ad4d35
      size: 319491073
  preprocess_dataset@DglPCQM4MDataset:
    cmd: PYTHONPATH=. python3 experiments/scripts/preprocess_dataset.py --dataset
      DglPCQM4MDataset
    deps:
    - path: experiments/scripts/preprocess_dataset.py
      md5: b9e78868a67857c569f56f3dda12b843
      size: 764
    - path: params.yaml
      md5: c6150b3423bceec54f97ce847cb5a86f
      size: 626
    outs:
    - path: data/dataset/pcqm4m_kddcup2021/processed/dgl_data_processed
      md5: 84adefff59b71dde2ad349af8e655ff3
      size: 14591225554
